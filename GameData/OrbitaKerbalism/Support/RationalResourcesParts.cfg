// Compatibility patches for RationalResourcesParts

// Reverse changes to airScoop
@PART[airScoop]:AFTER[RationalResourcesParts] {
	@mass = 0.02
	@category = Aero
	@cost = 250
	@TechRequired = aerodynamicSystems
}

// Adjust Liquid Scoop rates
@PART[liquidScoop]:NEEDS[RationalResourcesParts,!Kerbalism] {
	@MODULE[ModuleResourceHarvester],* {
		@Efficiency /= 5
		@INPUT_RESOURCE {
			@Ratio /= 5
		}
	}
}

// Convert Hydro Scoop
@PART[rr_hydroscoop_temp]:NEEDS[RationalResourcesParts,ProfileOrbita]:BEFORE[OrbitaKerbalism] {
	!MODULE[ModuleResourceIntake] {}
	!RESOURCE[*] {}
	OceanHarvester = true
}

@ORBITA_VARIABLES:BEFORE[OrbitaKerbalism]:NEEDS[RationalResourcesParts,!Kerbalism] {
	%RRHydroScoop {
		Efficiency = 3.0
		EC_Ratio = 6.0
	}
}

@PART[rr_hydroscoop_temp]:FOR[OrbitaKerbalism]:NEEDS[RationalResourcesParts,!Kerbalism] {
	!MODULE[ModuleResourceIntake] {}
	!RESOURCE[*] {}
	+MODULE[ModuleResourceHarvester]:HAS[#ResourceName[Water]] {
		@Efficiency = #$@ORBITA_VARIABLES/RRHydroScoop/Efficiency$
		@ResourceName = HydrogenPeroxide
		@ConverterName = #OrbitaLoc_LqdScp_HydrogenPeroxide_ConverterName
		@StartActionName = #OrbitaLoc_LqdScp_HydrogenPeroxide_StartActionName
		@StopActionName = #OrbitaLoc_LqdScp_HydrogenPeroxide_StopActionName
		@ToggleActionName = #OrbitaLoc_LqdScp_HydrogenPeroxide_ToggleActionName
	 	@INPUT_RESOURCE {
			@Ratio = #$@ORBITA_VARIABLES/RRHydroScoop/EC_Ratio$
	 	}
	}
	+MODULE[ModuleResourceHarvester]:HAS[#ResourceName[Water]] {
		@Efficiency = #$@ORBITA_VARIABLES/RRHydroScoop/Efficiency$
		@ResourceName = Kerosene
		@ConverterName = #OrbitaLoc_LqdScp_Kerosene_ConverterName
		@StartActionName = #OrbitaLoc_LqdScp_Kerosene_StartActionName
		@StopActionName = #OrbitaLoc_LqdScp_Kerosene_StopActionName
		@ToggleActionName = #OrbitaLoc_LqdScp_Kerosene_ToggleActionName
	 	@INPUT_RESOURCE {
			@Ratio = #$@ORBITA_VARIABLES/RRHydroScoop/EC_Ratio$
	 	}
	}
	+MODULE[ModuleResourceHarvester]:HAS[#ResourceName[Water]] {
		@Efficiency = #$@ORBITA_VARIABLES/RRHydroScoop/Efficiency$
		@ResourceName = LqdMethane
		@ConverterName = #OrbitaLoc_LqdScp_LqdMethane_ConverterName
		@StartActionName = #OrbitaLoc_LqdScp_LqdMethane_StartActionName
		@StopActionName = #OrbitaLoc_LqdScp_LqdMethane_StopActionName
		@ToggleActionName = #OrbitaLoc_LqdScp_LqdMethane_ToggleActionName
	 	@INPUT_RESOURCE {
			@Ratio = #$@ORBITA_VARIABLES/RRHydroScoop/EC_Ratio$
	 	}
	}
	+MODULE[ModuleResourceHarvester]:HAS[#ResourceName[Water]] {
		@Efficiency = #$@ORBITA_VARIABLES/RRHydroScoop/Efficiency$
		@ResourceName = LqdOxygen
		@ConverterName = #OrbitaLoc_LqdScp_LqdOxygen_ConverterName
		@StartActionName = #OrbitaLoc_LqdScp_LqdOxygen_StartActionName
		@StopActionName = #OrbitaLoc_LqdScp_LqdOxygen_StopActionName
		@ToggleActionName = #OrbitaLoc_LqdScp_LqdOxygen_ToggleActionName
	 	@INPUT_RESOURCE {
			@Ratio = #$@ORBITA_VARIABLES/RRHydroScoop/EC_Ratio$
	 	}
	}
	+MODULE[ModuleResourceHarvester]:HAS[#ResourceName[Water]] {
		@Efficiency = #$@ORBITA_VARIABLES/RRHydroScoop/Efficiency$
		@ResourceName = Salts
		@ConverterName = #OrbitaLoc_LqdScp_Salts_ConverterName
		@StartActionName = #OrbitaLoc_LqdScp_Salts_StartActionName
		@StopActionName = #OrbitaLoc_LqdScp_Salts_StopActionName
		@ToggleActionName = #OrbitaLoc_LqdScp_Salts_ToggleActionName
	 	@INPUT_RESOURCE {
			@Ratio = #$@ORBITA_VARIABLES/RRHydroScoop/EC_Ratio$
	 	}
	}
	@MODULE[ModuleResourceHarvester]:HAS[#ResourceName[Water]] {
		@Efficiency = #$@ORBITA_VARIABLES/RRHydroScoop/Efficiency$
		@ResourceName = Water
		@ConverterName = #OrbitaLoc_LqdScp_Water_ConverterName
		@StartActionName = #OrbitaLoc_LqdScp_Water_StartActionName
		@StopActionName = #OrbitaLoc_LqdScp_Water_StopActionName
		@ToggleActionName = #OrbitaLoc_LqdScp_Water_ToggleActionName
	 	@INPUT_RESOURCE {
			@Ratio = #$@ORBITA_VARIABLES/RRHydroScoop/EC_Ratio$
	 	}
	}
}

// Convert Exo Scoop
@PART[rr_exoscoop]:FOR[OrbiaKerbalism]:NEEDS[RationalResourcesParts,SpaceDust] {
	@TechRequired = experimentalScience
	@entryCost = 29000
	@cost = 94000
	// @title = RR Particle Scoop
	// @manufacturer = Kenron
	// @description = Apparently someone went wild with a very large heap of discarded laundry baskets and a shed load of Copper wire. This device can generate a conical magnetic field modestly larger than its physical frame, enabling effective uptake of gaseous particles into the filtration system which then leads to the best part... refilling the tank.
	// @tags = helium hydrogen harvest scoop particle
	MODULE {
		name = ModuleSpaceDustHarvester
		PowerCost = #$@PART[spacedust-atmosphere-processor-25-1]/MODULE[ModuleSpaceDustHarvester]/PowerCost$
		@PowerCost /= #$@PART[spacedust-atmosphere-processor-125-1]/MODULE[ModuleSpaceDustHarvester]/PowerCost$
		@PowerCost *= #$@PART[spacedust-atmosphere-processor-25-1]/MODULE[ModuleSpaceDustHarvester]/PowerCost$
		HarvestType = Exosphere
		IntakeArea = #$@PART[spacedust-atmosphere-processor-25-1]/MODULE[ModuleSpaceDustHarvester]/IntakeArea$
		@IntakeArea /= #$@PART[spacedust-atmosphere-processor-125-1]/MODULE[ModuleSpaceDustHarvester]/IntakeArea$
		@IntakeArea *= #$@PART[spacedust-atmosphere-processor-25-1]/MODULE[ModuleSpaceDustHarvester]/IntakeArea$
		IntakeSpeedStatic = #$@PART[spacedust-atmosphere-processor-25-1]/MODULE[ModuleSpaceDustHarvester]/IntakeSpeedStatic$
		@IntakeSpeedStatic /= #$@PART[spacedust-atmosphere-processor-125-1]/MODULE[ModuleSpaceDustHarvester]/IntakeSpeedStatic$
		@IntakeSpeedStatic *= #$@PART[spacedust-atmosphere-processor-25-1]/MODULE[ModuleSpaceDustHarvester]/IntakeSpeedStatic$
		IntakeVelocityScale {
		  key = 0 1
		}
		HARVESTED_RESOURCE {
			Name = Ammonia
			BaseEfficiency = #$@ORBITA_VARIABLES/SpaceDust/atmoBaseEfficiency$
			MinHarvestValue = #$@ORBITA_VARIABLES/SpaceDust/atmoMinHarvestValue$
		}
		HARVESTED_RESOURCE[ArgonGas]:NEEDS[NearFuturePropulsion] {
			Name = ArgonGas
			BaseEfficiency = #$@ORBITA_VARIABLES/SpaceDust/atmoBaseEfficiency$
			MinHarvestValue = #$@ORBITA_VARIABLES/SpaceDust/atmoMinHarvestValue$
		}
		HARVESTED_RESOURCE {
			Name = CarbonDioxide
			BaseEfficiency = #$@ORBITA_VARIABLES/SpaceDust/atmoBaseEfficiency$
			MinHarvestValue = #$@ORBITA_VARIABLES/SpaceDust/atmoMinHarvestValue$
		}
		HARVESTED_RESOURCE {
			Name = Hydrogen
			BaseEfficiency = #$@ORBITA_VARIABLES/SpaceDust/atmoBaseEfficiency$
			MinHarvestValue = #$@ORBITA_VARIABLES/SpaceDust/atmoMinHarvestValue$
		}
		HARVESTED_RESOURCE {
			Name = Methane
			BaseEfficiency = #$@ORBITA_VARIABLES/SpaceDust/atmoBaseEfficiency$
			MinHarvestValue = #$@ORBITA_VARIABLES/SpaceDust/atmoMinHarvestValue$
		}
		HARVESTED_RESOURCE {
			Name = Nitrogen
			BaseEfficiency = #$@ORBITA_VARIABLES/SpaceDust/atmoBaseEfficiency$
			MinHarvestValue = #$@ORBITA_VARIABLES/SpaceDust/atmoMinHarvestValue$
		}
		HARVESTED_RESOURCE {
			Name = Oxygen
			BaseEfficiency = #$@ORBITA_VARIABLES/SpaceDust/atmoBaseEfficiency$
			MinHarvestValue = #$@ORBITA_VARIABLES/SpaceDust/atmoMinHarvestValue$
		}
		HARVESTED_RESOURCE {
			Name = Water
			BaseEfficiency = #$@ORBITA_VARIABLES/SpaceDust/atmoBaseEfficiency$
			MinHarvestValue = #$@ORBITA_VARIABLES/SpaceDust/atmoMinHarvestValue$
		}
		HARVESTED_RESOURCE {
			Name = XenonGas
			BaseEfficiency = #$@ORBITA_VARIABLES/SpaceDust/atmoBaseEfficiency$
			MinHarvestValue = #$@ORBITA_VARIABLES/SpaceDust/atmoMinHarvestValue$
		}
	}
	!MODULE[ModuleAnimationGroup] {}
}

// Convert Metal Boosters
@PART[RREngineSRB_RT05,RREngineSRB_RT10]:NEEDS[RationalResourcesParts] {
	@MODULE[ModuleEnginesFX] {
		alMultiplier = #$@RESOURCE_DEFINITION[Metals]/density$
		@alMultiplier /= #$@RESOURCE_DEFINITION[Aluminium]/density$
		@PROPELLANT[Metals] {
			@name = Aluminium
			@ratio *= #$../alMultiplier$
		}
		oxMultiplier = #$@RESOURCE_DEFINITION[Oxidizer]/density$
		@oxMultiplier /= #$@RESOURCE_DEFINITION[LqdOxygen]/density$
		@PROPELLANT[Oxidizer] {
			@name = LqdOxygen
			@ratio *= #$../oxMultiplier$
		}
	}
	wetMass = #$/RESOURCE[Metals]/maxAmount$
	@wetMass *= #$@RESOURCE_DEFINITION[Metals]/density$
	@RESOURCE[Metals] {
		@name = Aluminium
		@amount = #$/wetMass$
		@amount /= #$@RESOURCE_DEFINITION[Aluminium]/density$
		@maxAmount = #$amount$
	}
}

// Remove LqdCarbonMonoxide from LV-N-O
@PART[RREngineNERVA-O]:AFTER[RationalResourcesParts] {
	@MODULE[ModuleB9PartSwitch] {
		!SUBTYPE[CarbonM] {}
	}
}

// Convert Processors (Kerbalism)
// Condensers
@PART[rr_boxblue_flat]:NEEDS[ProfileOrbita,RationalResourcesParts]:FOR[OrbitaKerbalism] {
	!MODULE[ModuleResourceConverter],* {}
	!MODULE[ModuleOverheatDisplay],* {}
	!MODULE[ModuleCoreHeat],* {}
	
	MODULE {
		name = ProcessController
		resource = _AmmoniaCondenser
		title = #OrbitaLoc_Kerbalism_process_ammonia-condenser
		capacity = 1
	}
	
	MODULE {
		name = ProcessController
		resource = _CarbonDioxideCondenser
		title = #OrbitaLoc_Kerbalism_process_carbon-dioxide-condenser
		capacity = 1
	}
	
	MODULE {
		name = ProcessController
		resource = _HydrogenCondenser
		title = #OrbitaLoc_Kerbalism_process_hydrogen-condenser
		capacity = 1
	}
	
	MODULE {
		name = ProcessController
		resource = _MethaneCondenser
		title = #OrbitaLoc_Kerbalism_process_methane-condenser
		capacity = 1
	}
	
	MODULE {
		name = ProcessController
		resource = _NitrogenCondenser
		title = #OrbitaLoc_Kerbalism_process_nitrogen-condenser
		capacity = 1
	}
	
	MODULE {
		name = ProcessController
		resource = _OxygenCondenser
		title = #OrbitaLoc_Kerbalism_process_oxygen-condenser
		capacity = 1
	}
	
	MODULE {
		name = Configure
		title = #OrbitaLoc_Kerbalism_types_isru
		slots = 2
		reconfigure = Engineer
		
		SETUP {
			name = #OrbitaLoc_Kerbalism_process_ammonia-condenser
			desc = #OrbitaLoc_Kerbalism_process_ammonia-condenser_desc
			mass = 0.05
			cost = 500

			MODULE {
				type = ProcessController
				id_field = resource
				id_value = _AmmoniaCondenser
			}
		}
		
		SETUP {
			name = #OrbitaLoc_Kerbalism_process_carbon-dioxide-condenser
			desc = #OrbitaLoc_Kerbalism_process_carbon-dioxide-condenser_desc
			mass = 0.05
			cost = 500

			MODULE {
				type = ProcessController
				id_field = resource
				id_value = _CarbonDioxideCondenser
			}
		}
		
		SETUP {
			name = #OrbitaLoc_Kerbalism_process_hydrogen-condenser
			desc = #OrbitaLoc_Kerbalism_process_hydrogen-condenser_desc
			mass = 0.05
			cost = 500

			MODULE {
				type = ProcessController
				id_field = resource
				id_value = _HydrogenCondenser
			}
		}
		
		SETUP {
			name = #OrbitaLoc_Kerbalism_process_methane-condenser
			desc = #OrbitaLoc_Kerbalism_process_methane-condenser_desc
			mass = 0.05
			cost = 500

			MODULE {
				type = ProcessController
				id_field = resource
				id_value = _MethaneCondenser
			}
		}
		
		SETUP {
			name = #OrbitaLoc_Kerbalism_process_nitrogen-condenser
			desc = #OrbitaLoc_Kerbalism_process_nitrogen-condenser_desc
			mass = 0.05
			cost = 500

			MODULE {
				type = ProcessController
				id_field = resource
				id_value = _NitrogenCondenser
			}
		}
		
		SETUP {
			name = #OrbitaLoc_Kerbalism_process_oxygen-condenser
			desc = #OrbitaLoc_Kerbalism_process_oxygen-condenser_desc
			mass = 0.05
			cost = 500

			MODULE {
				type = ProcessController
				id_field = resource
				id_value = _OxygenCondenser
			}
		}
		
		SETUP {
			name = #OrbitaLoc_Kerbalism_process_empty
			desc = #OrbitaLoc_Kerbalism_process_empty_desc
		}
	}
	
	MODULE:NEEDS[FeatureReliability] {
		name = Reliability
		type = ProcessController
		title = #OrbitaLoc_Kerbalism_types_isru
		repair = Engineer
		mtbf = 72576000
		extra_cost = 1.0
		extra_mass = 0.2
	}
}

// Evaporators
@PART[rr_boxred_flat]:NEEDS[ProfileOrbita,RationalResourcesParts]:FOR[OrbitaKerbalism] {
	!MODULE[ModuleResourceConverter],* {}
	!MODULE[ModuleOverheatDisplay],* {}
	!MODULE[ModuleCoreHeat],* {}

	MODULE {
		name = ProcessController
		resource = _AmmoniaEvaporator
		title = #OrbitaLoc_Kerbalism_process_ammonia-evaporator
		capacity = 1
	}

	MODULE {
		name = ProcessController
		resource = _CarbonDioxideEvaporator
		title = #OrbitaLoc_Kerbalism_process_carbon-dioxide-evaporator
		capacity = 1
	}

	MODULE {
		name = ProcessController
		resource = _HydrogenEvaporator
		title = #OrbitaLoc_Kerbalism_process_hydrogen-evaporator
		capacity = 1
	}

	MODULE {
		name = ProcessController
		resource = _MethaneEvaporator
		title = #OrbitaLoc_Kerbalism_process_methane-evaporator
		capacity = 1
	}

	MODULE {
		name = ProcessController
		resource = _NitrogenEvaporator
		title = #OrbitaLoc_Kerbalism_process_nitrogen-evaporator
		capacity = 1
	}

	MODULE {
		name = ProcessController
		resource = _OxygenEvaporator
		title = #OrbitaLoc_Kerbalism_process_oxygen-evaporator
		capacity = 1
	}

	MODULE {
		name = Configure
		title = #OrbitaLoc_Kerbalism_types_isru
		slots = 2
		reconfigure = Engineer
		
		SETUP {
			name = #OrbitaLoc_Kerbalism_process_ammonia-evaporator
			desc = #OrbitaLoc_Kerbalism_process_ammonia-evaporator_desc
			mass = 0.05
			cost = 500

			MODULE {
				type = ProcessController
				id_field = resource
				id_value = _AmmoniaEvaporator
			}
		}

		SETUP {
			name = #OrbitaLoc_Kerbalism_process_carbon-dioxide-evaporator
			desc = #OrbitaLoc_Kerbalism_process_carbon-dioxide-evaporator_desc
			mass = 0.05
			cost = 500

			MODULE {
				type = ProcessController
				id_field = resource
				id_value = _CarbonDioxideEvaporator
			}
		}

		SETUP {
			name = #OrbitaLoc_Kerbalism_process_hydrogen-evaporator
			desc = #OrbitaLoc_Kerbalism_process_hydrogen-evaporator_desc
			mass = 0.05
			cost = 500

			MODULE {
				type = ProcessController
				id_field = resource
				id_value = _HydrogenEvaporator
			}
		}

		SETUP {
			name = #OrbitaLoc_Kerbalism_process_methane-evaporator
			desc = #OrbitaLoc_Kerbalism_process_methane-evaporator_desc
			mass = 0.05
			cost = 500

			MODULE {
				type = ProcessController
				id_field = resource
				id_value = _MethaneEvaporator
			}
		}

		SETUP {
			name = #OrbitaLoc_Kerbalism_process_nitrogen-evaporator
			desc = #OrbitaLoc_Kerbalism_process_nitrogen-evaporator_desc
			mass = 0.05
			cost = 500

			MODULE {
				type = ProcessController
				id_field = resource
				id_value = _NitrogenEvaporator
			}
		}

		SETUP {
			name = #OrbitaLoc_Kerbalism_process_oxygen-evaporator
			desc = #OrbitaLoc_Kerbalism_process_oxygen-evaporator_desc
			mass = 0.05
			cost = 500

			MODULE {
				type = ProcessController
				id_field = resource
				id_value = _OxygenEvaporator
			}
		}

		SETUP {
			name = #OrbitaLoc_Kerbalism_process_empty
			desc = #OrbitaLoc_Kerbalism_process_empty_desc
		}
	}
	
	MODULE:NEEDS[FeatureReliability] {
		name = Reliability
		type = ProcessController
		title = #OrbitaLoc_Kerbalism_types_isru
		repair = Engineer
		mtbf = 72576000
		extra_cost = 1.0
		extra_mass = 0.2
	}
}

// Processors
@PART[rr_boxblue,rr_boxblue_long]:NEEDS[ProfileOrbita,RationalResourcesParts]:FOR[OrbitaKerbalism] {
	!MODULE[ModuleResourceConverter],* {}
	!MODULE[ModuleOverheatDisplay],* {}
	!MODULE[ModuleCoreHeat],* {}

	MODULE {
		name = ProcessController
		resource = _CrystalProcessor
		title = #OrbitaLoc_Kerbalism_process_crystal-processor
		capacity = 1
		valve_i = 2 // workaround until we have a better way to deal with dump valves
	}
	
	MODULE {
		name = ProcessController
		resource = _IceProcessor
		title = #OrbitaLoc_Kerbalism_process_ice-processor
		capacity = 1
	}
	
	MODULE {
		name = ProcessController
		resource = _MetalProcessor
		title = #OrbitaLoc_Kerbalism_process_metal-processor
		capacity = 1
	}
	
	MODULE {
		name = ProcessController
		resource = _RockProcessor
		title = #OrbitaLoc_Kerbalism_process_rock-processor
		capacity = 1
	}
	
	MODULE {
		name = ProcessController
		resource = _SaltProcessor
		title = #OrbitaLoc_Kerbalism_process_salt-processor
		capacity = 1
	}
	
	MODULE {
		name = ProcessController
		resource = _PetroleumRefinery
		title = #OrbitaLoc_Kerbalism_process_petroleum-refinery
		capacity = 1
	}
	
	MODULE {
		name = ProcessController
		resource = _SabatierReactor
		title = #OrbitaLoc_Kerbalism_process_sabatier-reactor
		capacity = 1
	}
	
	MODULE {
		name = ProcessController
		resource = _HaberProcessor
		title = #OrbitaLoc_Kerbalism_process_haber-processor
		capacity = 1
	}
	
	MODULE {
		name = ProcessController
		resource = _AnthraquinoneProcessor
		title = #OrbitaLoc_Kerbalism_process_anthraquinone-processor
		capacity = 1
	}
	
	MODULE {
		name = ProcessController
		resource = _HydrazineProduction
		title = #OrbitaLoc_Kerbalism_process_hydrazine-production
		capacity = 1
	}
	
	MODULE {
		name = ProcessController
		resource = _SelectiveCatalyticOxidation
		title = #OrbitaLoc_Kerbalism_process_selective-catalytic-oxidation
		capacity = 1
	}

	MODULE {
		name = ProcessController
		resource = _WaterElectrolysis
		title = #OrbitaLoc_Kerbalism_process_water-electrolysis
		capacity = 1
	}
	
	MODULE {
		name = ProcessController
		resource = _CarbonDioxideElectrolysis
		title = #OrbitaLoc_Kerbalism_process_carbon-dioxide-electrolysis
		capacity = 1
	}
	
	MODULE {
		name = ProcessController
		resource = _MethanePyrolysis
		title = #OrbitaLoc_Kerbalism_process_methane-pyrolysis
		capacity = 1
	}
	
	MODULE {
		name = ProcessController
		resource = _AmmoniaDecomposition
		title = #OrbitaLoc_Kerbalism_process_ammonia-decomposition
		capacity = 1
	}
	
	MODULE {
		name = Configure
		title = #OrbitaLoc_Kerbalism_types_isru
		slots = 4
		reconfigure = Engineer
		
		SETUP {
			name = #OrbitaLoc_Kerbalism_process_crystal-processor
			desc = #OrbitaLoc_Kerbalism_process_crystal-processor_desc
			mass = 0.15
			cost = 1500

			MODULE {
				type = ProcessController
				id_field = resource
				id_value = _CrystalProcessor
			}
		}
		
		SETUP {
			name = #OrbitaLoc_Kerbalism_process_ice-processor
			desc = #OrbitaLoc_Kerbalism_process_ice-processor_desc
			mass = 0.15
			cost = 1500

			MODULE {
				type = ProcessController
				id_field = resource
				id_value = _IceProcessor
			}
		}
		
		SETUP {
			name = #OrbitaLoc_Kerbalism_process_metal-processor
			desc = #OrbitaLoc_Kerbalism_process_metal-processor_desc
			mass = 0.15
			cost = 1500

			MODULE {
				type = ProcessController
				id_field = resource
				id_value = _MetalProcessor
			}
		}
		
		SETUP {
			name = #OrbitaLoc_Kerbalism_process_rock-processor
			desc = #OrbitaLoc_Kerbalism_process_rock-processor_desc
			mass = 0.15
			cost = 1500

			MODULE {
				type = ProcessController
				id_field = resource
				id_value = _RockProcessor
			}
		}
		
		SETUP {
			name = #OrbitaLoc_Kerbalism_process_salt-processor
			desc = #OrbitaLoc_Kerbalism_process_salt-processor_desc
			mass = 0.15
			cost = 1500

			MODULE {
				type = ProcessController
				id_field = resource
				id_value = _SaltProcessor
			}
		}
		
		SETUP {
			name = #OrbitaLoc_Kerbalism_process_petroleum-refinery
			desc = #OrbitaLoc_Kerbalism_process_petroleum-refinery_desc
			mass = 0.1
			cost = 1000

			MODULE {
				type = ProcessController
				id_field = resource
				id_value = _PetroleumRefinery
			}
		}
		
		SETUP {
			name = #OrbitaLoc_Kerbalism_process_sabatier-reactor
			desc = #OrbitaLoc_Kerbalism_process_sabatier-reactor_desc
			mass = 0.075
			cost = 1750

			MODULE {
				type = ProcessController
				id_field = resource
				id_value = _SabatierReactor
			}
		}
		
		SETUP {
			name = #OrbitaLoc_Kerbalism_process_haber-processor
			desc = #OrbitaLoc_Kerbalism_process_haber-processor_desc
			mass = 0.075
			cost = 1750

			MODULE {
				type = ProcessController
				id_field = resource
				id_value = _HaberProcessor
			}
		}
		
		SETUP {
			name = #OrbitaLoc_Kerbalism_process_anthraquinone-processor
			desc = #OrbitaLoc_Kerbalism_process_anthraquinone-processor_desc
			mass = 0.075
			cost = 1750

			MODULE {
				type = ProcessController
				id_field = resource
				id_value = _AnthraquinoneProcessor
			}
		}
		
		SETUP {
			name = #OrbitaLoc_Kerbalism_process_hydrazine-production
			desc = #OrbitaLoc_Kerbalism_process_hydrazine-production_desc
			mass = 0.075
			cost = 1750

			MODULE {
				type = ProcessController
				id_field = resource
				id_value = _HydrazineProduction
			}
		}
		
		SETUP {
			name = #OrbitaLoc_Kerbalism_process_selective-catalytic-oxidation
			desc = #OrbitaLoc_Kerbalism_process_selective-catalytic-oxidation_desc
			mass = 0.075
			cost = 1750

			MODULE {
				type = ProcessController
				id_field = resource
				id_value = _SelectiveCatalyticOxidation
			}
		}
		
		SETUP {
			name = #OrbitaLoc_Kerbalism_process_water-electrolysis
			desc = #OrbitaLoc_Kerbalism_process_water-electrolysis_desc
			mass = 0.075
			cost = 1750

			MODULE {
				type = ProcessController
				id_field = resource
				id_value = _WaterElectrolysis
			}
		}
		
		SETUP {
			name = #OrbitaLoc_Kerbalism_process_carbon-dioxide-electrolysis
			desc = #OrbitaLoc_Kerbalism_process_carbon-dioxide-electrolysis_desc
			mass = 0.075
			cost = 1750

			MODULE {
				type = ProcessController
				id_field = resource
				id_value = _CarbonDioxideElectrolysis
			}
		}
		
		SETUP {
			name = #OrbitaLoc_Kerbalism_process_methane-pyrolysis
			desc = #OrbitaLoc_Kerbalism_process_methane-pyrolysis_desc
			mass = 0.075
			cost = 1750

			MODULE {
				type = ProcessController
				id_field = resource
				id_value = _MethanePyrolysis
			}
		}
		
		SETUP {
			name = #OrbitaLoc_Kerbalism_process_ammonia-decomposition
			desc = #OrbitaLoc_Kerbalism_process_ammonia-decomposition_desc
			mass = 0.075
			cost = 1750

			MODULE {
				type = ProcessController
				id_field = resource
				id_value = _AmmoniaDecomposition
			}
		}
		
		SETUP {
			name = #OrbitaLoc_Kerbalism_process_empty
			desc = #OrbitaLoc_Kerbalism_process_empty_desc
		}
	}

	MODULE:NEEDS[FeatureReliability] {
		name = Reliability
		type = ProcessController
		title = #OrbitaLoc_Kerbalism_types_isru
		repair = Engineer
		mtbf = 72576000
		extra_cost = 1.0
		extra_mass = 0.2
	}
}

@PART[rr_boxblue]:NEEDS[ProfileOrbita,RationalResourcesParts]:AFTER[OrbitaKerbalism] {
	@MODULE[ProcessController],* {
		@capacity /= 2
	}

	@MODULE[Configure] {
		@slots /= 2
		
		@SETUP:HAS[@RESOURCE[*]] {
			@RESOURCE[*] {
				@maxAmount /= 2
			}
		}
	}
}

// Convert Processors (Stock)
// Condensers
@PART[rr_boxblue_flat]:NEEDS[!Kerbalism]:AFTER[RationalResourcesParts] {
	// Ammonia Condensor
	+MODULE[ModuleResourceConverter],0 {
		@ConverterName = #OrbitaLoc_ISRU_ammonia-condenser_ConverterName
		@StartActionName = #OrbitaLoc_ISRU_ammonia-condenser_StartActionName
		@StopActionName = #OrbitaLoc_ISRU_ammonia-condenser_StopActionName
		@resourceOutputName = #OrbitaLoc_ammonia-condenser_resourceOutputName

		!INPUT_RESOURCE:HAS[#ResourceName[*]] {}
		!OUTPUT_RESOURCE:HAS[#ResourceName[*]] {}
		INPUT_RESOURCE {
			ResourceName = Ammonia
			Ratio = 1084.648635
			FlowMode = STAGE_PRIORITY_FLOW
		}
		INPUT_RESOURCE {
			ResourceName = ElectricCharge
			Ratio = 0.232862612
		}
		OUTPUT_RESOURCE {
			ResourceName = LqdAmmonia
			Ratio = 1.188
			DumpExcess = false
			FlowMode = STAGE_PRIORITY_FLOW
		}
	}
	
	// Carbon Dioxide Condensor
	+MODULE[ModuleResourceConverter],0 {
		@ConverterName = #OrbitaLoc_ISRU_carbon-dioxide-condenser_ConverterName
		@StartActionName = #OrbitaLoc_ISRU_carbon-dioxide-condenser_StartActionName
		@StopActionName = #OrbitaLoc_ISRU_carbon-dioxide-condenser_StopActionName
		@resourceOutputName = #OrbitaLoc_carbon-dioxide-condenser_resourceOutputName

		!INPUT_RESOURCE:HAS[#ResourceName[*]] {}
		!OUTPUT_RESOURCE:HAS[#ResourceName[*]] {}
		INPUT_RESOURCE {
			ResourceName = CarbonDioxide
			Ratio = 1190.099032
			FlowMode = STAGE_PRIORITY_FLOW
		}
		INPUT_RESOURCE {
			ResourceName = ElectricCharge
			Ratio = 0.195384712
		}
		OUTPUT_RESOURCE {
			ResourceName = LqdCO2
			Ratio = 1.979
			DumpExcess = false
			FlowMode = STAGE_PRIORITY_FLOW
		}
	}
	
	// Hydrogen Condensor
	+MODULE[ModuleResourceConverter],0 {
		@ConverterName = #OrbitaLoc_ISRU_hydrogen-condenser_ConverterName
		@StartActionName = #OrbitaLoc_ISRU_hydrogen-condenser_StartActionName
		@StopActionName = #OrbitaLoc_ISRU_hydrogen-condenser_StopActionName
		@resourceOutputName = #OrbitaLoc_hydrogen-condenser_resourceOutputName

		!INPUT_RESOURCE:HAS[#ResourceName[*]] {}
		!OUTPUT_RESOURCE:HAS[#ResourceName[*]] {}
		INPUT_RESOURCE {
			ResourceName = Hydrogen
			Ratio = 5910.734149
			FlowMode = STAGE_PRIORITY_FLOW
		}
		INPUT_RESOURCE {
			ResourceName = ElectricCharge
			Ratio = 2.0758875
		}
		OUTPUT_RESOURCE {
			ResourceName = LqdHydrogen
			Ratio = 7.5
			DumpExcess = false
			FlowMode = STAGE_PRIORITY_FLOW
		}
	}
	
	// Methane Condensor
	+MODULE[ModuleResourceConverter],0 {
		@ConverterName = #OrbitaLoc_ISRU_methane-condenser_ConverterName
		@StartActionName = #OrbitaLoc_ISRU_methane-condenser_StartActionName
		@StopActionName = #OrbitaLoc_ISRU_methane-condenser_StopActionName
		@resourceOutputName = #OrbitaLoc_methane-condenser_resourceOutputName

		!INPUT_RESOURCE:HAS[#ResourceName[*]] {}
		!OUTPUT_RESOURCE:HAS[#ResourceName[*]] {}
		INPUT_RESOURCE {
			ResourceName = Methane
			Ratio = 2967.991632
			FlowMode = STAGE_PRIORITY_FLOW
		}
		INPUT_RESOURCE {
			ResourceName = ElectricCharge
			Ratio = 1.297085
		}
		OUTPUT_RESOURCE {
			ResourceName = LqdMethane
			Ratio = 5.0
			DumpExcess = false
			FlowMode = STAGE_PRIORITY_FLOW
		}
	}
	
	// Nitrogen Condensor
	+MODULE[ModuleResourceConverter],0 {
		@ConverterName = #OrbitaLoc_ISRU_nitrogen-condenser_ConverterName
		@StartActionName = #OrbitaLoc_ISRU_nitrogen-condenser_StartActionName
		@StopActionName = #OrbitaLoc_ISRU_nitrogen-condenser_StopActionName
		@resourceOutputName = #OrbitaLoc_nitrogen-condenser_resourceOutputName

		!INPUT_RESOURCE:HAS[#ResourceName[*]] {}
		!OUTPUT_RESOURCE:HAS[#ResourceName[*]] {}
		INPUT_RESOURCE {
			ResourceName = Nitrogen
			Ratio = 2176.013669
			FlowMode = STAGE_PRIORITY_FLOW
		}
		INPUT_RESOURCE {
			ResourceName = ElectricCharge
			Ratio = 1.1995071
		}
		OUTPUT_RESOURCE {
			ResourceName = LqdNitrogen
			Ratio = 3.3
			DumpExcess = false
			FlowMode = STAGE_PRIORITY_FLOW
		}
	}
	
	// Oxygen Condensor
	+MODULE[ModuleResourceConverter],0 {
		@ConverterName = #OrbitaLoc_ISRU_oxygen-condenser_ConverterName
		@StartActionName = #OrbitaLoc_ISRU_oxygen-condenser_StartActionName
		@StopActionName = #OrbitaLoc_ISRU_oxygen-condenser_StopActionName
		@resourceOutputName = #OrbitaLoc_oxygen-condenser_resourceOutputName

		!INPUT_RESOURCE:HAS[#ResourceName[*]] {}
		!OUTPUT_RESOURCE:HAS[#ResourceName[*]] {}
		INPUT_RESOURCE {
			ResourceName = Oxygen
			Ratio = 3546.099291
			FlowMode = STAGE_PRIORITY_FLOW
		}
		INPUT_RESOURCE {
			ResourceName = ElectricCharge
			Ratio = 0.933799299
		}
		OUTPUT_RESOURCE {
			ResourceName = LqdOxygen
			Ratio = 4.382120947
			DumpExcess = false
			FlowMode = STAGE_PRIORITY_FLOW
		}
	}
	
	!MODULE[ModuleResourceConverter]:HAS[#StartActionName[Start?Heater?Ammonia]] {}
}

// Evaporators
@PART[rr_boxred_flat]:NEEDS[!Kerbalism]:AFTER[RationalResourcesParts] {
	// Ammonia Evaporator
	+MODULE[ModuleResourceConverter],0 {
		@ConverterName = #OrbitaLoc_ISRU_ammonia-evaporator_ConverterName
		@StartActionName = #OrbitaLoc_ISRU_ammonia-evaporator_StartActionName
		@StopActionName = #OrbitaLoc_ISRU_ammonia-evaporator_StopActionName
		@resourceOutputName = #OrbitaLoc_ammonia-evaporator_resourceOutputName

		!INPUT_RESOURCE:HAS[#ResourceName[*]] {}
		!OUTPUT_RESOURCE:HAS[#ResourceName[*]] {}
		INPUT_RESOURCE {
			ResourceName = LqdAmmonia
			Ratio = 1.188
			FlowMode = STAGE_PRIORITY_FLOW
		}
		INPUT_RESOURCE {
			ResourceName = ElectricCharge
			Ratio = 0.232862612
		}
		OUTPUT_RESOURCE {
			ResourceName = Ammonia
			Ratio = 1084.648635
			DumpExcess = false
			FlowMode = STAGE_PRIORITY_FLOW
		}
	}

	// Carbon Dioxide Evaporator
	+MODULE[ModuleResourceConverter],0 {
		@ConverterName = #OrbitaLoc_ISRU_carbon-dioxide-evaporator_ConverterName
		@StartActionName = #OrbitaLoc_ISRU_carbon-dioxide-evaporator_StartActionName
		@StopActionName = #OrbitaLoc_ISRU_carbon-dioxide-evaporator_StopActionName
		@resourceOutputName = #OrbitaLoc_carbon-dioxide-evaporator_resourceOutputName

		!INPUT_RESOURCE:HAS[#ResourceName[*]] {}
		!OUTPUT_RESOURCE:HAS[#ResourceName[*]] {}
		INPUT_RESOURCE {
			ResourceName = LqdCO2
			Ratio = 1.979
			FlowMode = STAGE_PRIORITY_FLOW
		}
		INPUT_RESOURCE {
			ResourceName = ElectricCharge
			Ratio = 0.195384712
		}
		OUTPUT_RESOURCE {
			ResourceName = CarbonDioxide
			Ratio = 1190.099032
			DumpExcess = false
			FlowMode = STAGE_PRIORITY_FLOW
		}
	}

	// Hydrogen Evaporator
	+MODULE[ModuleResourceConverter],0 {
		@ConverterName = #OrbitaLoc_ISRU_hydrogen-evaporator_ConverterName
		@StartActionName = #OrbitaLoc_ISRU_hydrogen-evaporator_StartActionName
		@StopActionName = #OrbitaLoc_ISRU_hydrogen-evaporator_StopActionName
		@resourceOutputName = #OrbitaLoc_hydrogen-evaporator_resourceOutputName

		!INPUT_RESOURCE:HAS[#ResourceName[*]] {}
		!OUTPUT_RESOURCE:HAS[#ResourceName[*]] {}
		INPUT_RESOURCE {
			ResourceName = LqdHydrogen
			Ratio = 7.5
			FlowMode = STAGE_PRIORITY_FLOW
		}
		INPUT_RESOURCE {
			ResourceName = ElectricCharge
			Ratio = 2.0758875
		}
		OUTPUT_RESOURCE {
			ResourceName = Hydrogen
			Ratio = 5910.734149
			DumpExcess = false
			FlowMode = STAGE_PRIORITY_FLOW
		}
	}

	// Methane Evaporator
	+MODULE[ModuleResourceConverter],0 {
		@ConverterName = #OrbitaLoc_ISRU_methane-evaporator_ConverterName
		@StartActionName = #OrbitaLoc_ISRU_methane-evaporator_StartActionName
		@StopActionName = #OrbitaLoc_ISRU_methane-evaporator_StopActionName
		@resourceOutputName = #OrbitaLoc_methane-evaporator_resourceOutputName

		!INPUT_RESOURCE:HAS[#ResourceName[*]] {}
		!OUTPUT_RESOURCE:HAS[#ResourceName[*]] {}
		INPUT_RESOURCE {
			ResourceName = LqdMethane
			Ratio = 5.0
			FlowMode = STAGE_PRIORITY_FLOW
		}
		INPUT_RESOURCE {
			ResourceName = ElectricCharge
			Ratio = 1.297085
		}
		OUTPUT_RESOURCE {
			ResourceName = Methane
			Ratio = 2967.991632
			DumpExcess = false
			FlowMode = STAGE_PRIORITY_FLOW
		}
	}

	// Nitrogen Evaporator
	+MODULE[ModuleResourceConverter],0 {
		@ConverterName = #OrbitaLoc_ISRU_nitrogen-evaporator_ConverterName
		@StartActionName = #OrbitaLoc_ISRU_nitrogen-evaporator_StartActionName
		@StopActionName = #OrbitaLoc_ISRU_nitrogen-evaporator_StopActionName
		@resourceOutputName = #OrbitaLoc_nitrogen-evaporator_resourceOutputName

		!INPUT_RESOURCE:HAS[#ResourceName[*]] {}
		!OUTPUT_RESOURCE:HAS[#ResourceName[*]] {}
		INPUT_RESOURCE {
			ResourceName = LqdNitrogen
			Ratio = 3.3
			FlowMode = STAGE_PRIORITY_FLOW
		}
		INPUT_RESOURCE {
			ResourceName = ElectricCharge
			Ratio = 1.1995071
		}
		OUTPUT_RESOURCE {
			ResourceName = Nitrogen
			Ratio = 2176.013669
			DumpExcess = false
			FlowMode = STAGE_PRIORITY_FLOW
		}
	}

	// Oxygen Evaporator
	+MODULE[ModuleResourceConverter],0 {
		@ConverterName = #OrbitaLoc_ISRU_oxygen-evaporator_ConverterName
		@StartActionName = #OrbitaLoc_ISRU_oxygen-evaporator_StartActionName
		@StopActionName = #OrbitaLoc_ISRU_oxygen-evaporator_StopActionName
		@resourceOutputName = #OrbitaLoc_oxygen-evaporator_resourceOutputName

		!INPUT_RESOURCE:HAS[#ResourceName[*]] {}
		!OUTPUT_RESOURCE:HAS[#ResourceName[*]] {}
		INPUT_RESOURCE {
			ResourceName = LqdOxygen
			Ratio = 4.382120947
			FlowMode = STAGE_PRIORITY_FLOW
		}
		INPUT_RESOURCE {
			ResourceName = ElectricCharge
			Ratio = 0.933799299
		}
		OUTPUT_RESOURCE {
			ResourceName = Oxygen
			Ratio = 3546.099291
			DumpExcess = false
			FlowMode = STAGE_PRIORITY_FLOW
		}
	}

	!MODULE[ModuleResourceConverter]:HAS[#StartActionName[Start?Freezer?Ammonia]] {}
}

// Processors
@PART[rr_boxblue,rr_boxblue_long]:NEEDS[!Kerbalism]:AFTER[RationalResourcesParts] {
	// Crystal Processor
	+MODULE[ModuleResourceConverter],0 {
		@ConverterName = #OrbitaLoc_ISRU_crystal-processor_ConverterName
		@StartActionName = #OrbitaLoc_ISRU_crystal-processor_StartActionName
		@StopActionName = #OrbitaLoc_ISRU_crystal-processor_StopActionName
		@resourceOutputName = #OrbitaLoc_ISRU_crystal-processor_resourceOutputName

		!INPUT_RESOURCE:HAS[#ResourceName[*]] {}
		!OUTPUT_RESOURCE:HAS[#ResourceName[*]] {}
		INPUT_RESOURCE {
			ResourceName = Crystals
			Ratio = 1.0
			FlowMode = STAGE_PRIORITY_FLOW
		}
		INPUT_RESOURCE {
			ResourceName = ElectricCharge
			Ratio = 0.54068285
		}
		OUTPUT_RESOURCE {
			ResourceName = CarbonDioxide
			Ratio = 644.031266
			DumpExcess = true
			FlowMode = STAGE_PRIORITY_FLOW
		}
		OUTPUT_RESOURCE {
			ResourceName = Oxygen
			Ratio = 323.9822695
			DumpExcess = true
			FlowMode = STAGE_PRIORITY_FLOW
		}
		OUTPUT_RESOURCE {
			ResourceName = Lithium
			Ratio = 0.742846442
			DumpExcess = false
			FlowMode = STAGE_PRIORITY_FLOW
		}
	}
	
	// Ice Processor
	+MODULE[ModuleResourceConverter],0 {
		@ConverterName = #OrbitaLoc_ISRU_ice-processor_ConverterName
		@StartActionName = #OrbitaLoc_ISRU_ice-processor_StartActionName
		@StopActionName = #OrbitaLoc_ISRU_ice-processor_StopActionName
		@resourceOutputName = #OrbitaLoc_ISRU_ice-processor_resourceOutputName

		!INPUT_RESOURCE:HAS[#ResourceName[*]] {}
		!OUTPUT_RESOURCE:HAS[#ResourceName[*]] {}
		INPUT_RESOURCE {
			ResourceName = Ices
			Ratio = 1.0
			FlowMode = STAGE_PRIORITY_FLOW
		}
		INPUT_RESOURCE {
			ResourceName = ElectricCharge
			Ratio = 0.19097245
		}
		OUTPUT_RESOURCE {
			ResourceName = Water
			Ratio = 0.313541972
			DumpExcess = true
			FlowMode = STAGE_PRIORITY_FLOW
		}
		OUTPUT_RESOURCE {
			ResourceName = CarbonDioxide
			Ratio = 130.8243772
			DumpExcess = true
			FlowMode = STAGE_PRIORITY_FLOW
		}
		OUTPUT_RESOURCE {
			ResourceName = Methane
			Ratio = 259.5446583
			DumpExcess = true
			FlowMode = STAGE_PRIORITY_FLOW
		}
		OUTPUT_RESOURCE {
			ResourceName = Ammonia
			Ratio = 128.4345228
			DumpExcess = true
			FlowMode = STAGE_PRIORITY_FLOW
		}
	}
	
	// Metal Processor
	+MODULE[ModuleResourceConverter],0 {
		@ConverterName = #OrbitaLoc_ISRU_metal-processor_ConverterName
		@StartActionName = #OrbitaLoc_ISRU_metal-processor_StartActionName
		@StopActionName = #OrbitaLoc_ISRU_metal-processor_StopActionName
		@resourceOutputName = #OrbitaLoc_ISRU_metal-processor_resourceOutputName

		!INPUT_RESOURCE:HAS[#ResourceName[*]] {}
		!OUTPUT_RESOURCE:HAS[#ResourceName[*]] {}
		INPUT_RESOURCE {
			ResourceName = Metallics
			Ratio = 1.0
			FlowMode = STAGE_PRIORITY_FLOW
		}
		INPUT_RESOURCE {
			ResourceName = ElectricCharge
			Ratio = 5.6068825
		}
		OUTPUT_RESOURCE {
			ResourceName = Oxygen
			Ratio = 1048.315603
			DumpExcess = true
			FlowMode = STAGE_PRIORITY_FLOW
		}
		OUTPUT_RESOURCE {
			ResourceName = Silicon
			Ratio = 0.278542293
			DumpExcess = true
			FlowMode = STAGE_PRIORITY_FLOW
		}
		OUTPUT_RESOURCE {
			ResourceName = Aluminium
			Ratio = 0.224963899
			DumpExcess = false
			FlowMode = STAGE_PRIORITY_FLOW
		}
	}
	
	// Rock Processor
	+MODULE[ModuleResourceConverter],0 {
		@ConverterName = #OrbitaLoc_ISRU_rock-processor_ConverterName
		@StartActionName = #OrbitaLoc_ISRU_rock-processor_StartActionName
		@StopActionName = #OrbitaLoc_ISRU_rock-processor_StopActionName
		@resourceOutputName = #OrbitaLoc_ISRU_rock-processor_resourceOutputName

		!INPUT_RESOURCE:HAS[#ResourceName[*]] {}
		!OUTPUT_RESOURCE:HAS[#ResourceName[*]] {}
		INPUT_RESOURCE {
			ResourceName = Rocks
			Ratio = 1.0
			FlowMode = STAGE_PRIORITY_FLOW
		}
		INPUT_RESOURCE {
			ResourceName = ElectricCharge
			Ratio = 3.6270701
		}
		OUTPUT_RESOURCE {
			ResourceName = Oxygen
			Ratio = 1000.609929
			DumpExcess = true
			FlowMode = STAGE_PRIORITY_FLOW
		}
		OUTPUT_RESOURCE {
			ResourceName = Silicon
			Ratio = 0.531820524
			DumpExcess = true
			FlowMode = STAGE_PRIORITY_FLOW
		}
		OUTPUT_RESOURCE {
			ResourceName = Uraninite
			Ratio = 0.000070667
			DumpExcess = false
			FlowMode = STAGE_PRIORITY_FLOW
		}
	}
	
	// Salt Processor
	+MODULE[ModuleResourceConverter],0 {
		@ConverterName = #OrbitaLoc_ISRU_salt-processor_ConverterName
		@StartActionName = #OrbitaLoc_ISRU_salt-processor_StartActionName
		@StopActionName = #OrbitaLoc_ISRU_salt-processor_StopActionName
		@resourceOutputName = #OrbitaLoc_ISRU_salt-processor_resourceOutputName

		!INPUT_RESOURCE:HAS[#ResourceName[*]] {}
		!OUTPUT_RESOURCE:HAS[#ResourceName[*]] {}
		INPUT_RESOURCE {
			ResourceName = Salts
			Ratio = 1.0
			FlowMode = STAGE_PRIORITY_FLOW
		}
		INPUT_RESOURCE {
			ResourceName = ElectricCharge
			Ratio = 0.51775875
		}
		OUTPUT_RESOURCE {
			ResourceName = Oxygen
			Ratio = 733.6755319
			DumpExcess = true
			FlowMode = STAGE_PRIORITY_FLOW
		}
		OUTPUT_RESOURCE {
			ResourceName = Ammonia
			Ratio = 477.3472042
			DumpExcess = false
			FlowMode = STAGE_PRIORITY_FLOW
		}
		OUTPUT_RESOURCE {
			ResourceName = Nitrogen
			Ratio = 241.3069544
			DumpExcess = true
			FlowMode = STAGE_PRIORITY_FLOW
		}
		OUTPUT_RESOURCE {
			ResourceName = Hydrogen
			Ratio = 241.7686318
			DumpExcess = true
			FlowMode = STAGE_PRIORITY_FLOW
		}
	}
	
	// Petroleum Refinery
	+MODULE[ModuleResourceConverter],0 {
		@ConverterName = #OrbitaLoc_ISRU_petroleum-refinery_ConverterName
		@StartActionName = #OrbitaLoc_ISRU_petroleum-refinery_StartActionName
		@StopActionName = #OrbitaLoc_ISRU_petroleum-refinery_StopActionName
		@resourceOutputName = #OrbitaLoc_ISRU_petroleum-refinery_resourceOutputName

		!INPUT_RESOURCE:HAS[#ResourceName[*]] {}
		!OUTPUT_RESOURCE:HAS[#ResourceName[*]] {}
		INPUT_RESOURCE {
			ResourceName = Petroleum
			Ratio = 1.0
			FlowMode = STAGE_PRIORITY_FLOW
		}
		INPUT_RESOURCE {
			ResourceName = ElectricCharge
			Ratio = 0.388175025
		}
		OUTPUT_RESOURCE {
			ResourceName = Kerosene
			Ratio = 1.036585366
			DumpExcess = false
			FlowMode = STAGE_PRIORITY_FLOW
		}
	}
	
	// Sabatier Reactor
	+MODULE[ModuleResourceConverter],0 {
		@ConverterName = #OrbitaLoc_ISRU_sabatier-reactor_ConverterName
		@StartActionName = #OrbitaLoc_ISRU_sabatier-reactor_StartActionName
		@StopActionName = #OrbitaLoc_ISRU_sabatier-reactor_StopActionName
		@resourceOutputName = #OrbitaLoc_ISRU_sabatier-reactor_resourceOutputName

		!INPUT_RESOURCE:HAS[#ResourceName[*]] {}
		!OUTPUT_RESOURCE:HAS[#ResourceName[*]] {}
		INPUT_RESOURCE {
			ResourceName = LqdCO2
			Ratio = 0.722263652
			FlowMode = STAGE_PRIORITY_FLOW
		}
		INPUT_RESOURCE {
			ResourceName = LqdHydrogen
			Ratio = 2.190574035
			FlowMode = STAGE_PRIORITY_FLOW
		}
		INPUT_RESOURCE {
			ResourceName = ElectricCharge
			Ratio = 0.8405442
		}
		OUTPUT_RESOURCE {
			ResourceName = Water
			Ratio = 0.693797816
			DumpExcess = true
			FlowMode = STAGE_PRIORITY_FLOW
		}
		OUTPUT_RESOURCE {
			ResourceName = Methane
			Ratio = 430.6836597
			DumpExcess = false
			FlowMode = STAGE_PRIORITY_FLOW
		}
	}
	
	// Haber Processor
	+MODULE[ModuleResourceConverter],0 {
		@ConverterName = #OrbitaLoc_ISRU_haber-processor_ConverterName
		@StartActionName = #OrbitaLoc_ISRU_haber-processor_StartActionName
		@StopActionName = #OrbitaLoc_ISRU_haber-processor_StopActionName
		@resourceOutputName = #OrbitaLoc_ISRU_haber-processor_resourceOutputName

		!INPUT_RESOURCE:HAS[#ResourceName[*]] {}
		!OUTPUT_RESOURCE:HAS[#ResourceName[*]] {}
		INPUT_RESOURCE {
			ResourceName = LqdNitrogen
			Ratio = 0.688886003
			FlowMode = STAGE_PRIORITY_FLOW
		}
		INPUT_RESOURCE {
			ResourceName = LqdHydrogen
			Ratio = 1.732097581
			FlowMode = STAGE_PRIORITY_FLOW
		}
		INPUT_RESOURCE {
			ResourceName = ElectricCharge
			Ratio = 1.16128955
		}
		OUTPUT_RESOURCE {
			ResourceName = Ammonia
			Ratio = 898.5513654
			DumpExcess = false
			FlowMode = STAGE_PRIORITY_FLOW
		}
	}

	// Anthraquinone Processor
	+MODULE[ModuleResourceConverter],0 {
		@ConverterName = #OrbitaLoc_ISRU_anthraquinone-processor_ConverterName
		@StartActionName = #OrbitaLoc_ISRU_anthraquinone-processor_StartActionName
		@StopActionName = #OrbitaLoc_ISRU_anthraquinone-processor_StopActionName
		@resourceOutputName = #OrbitaLoc_ISRU_anthraquinone-processor_resourceOutputName

		!INPUT_RESOURCE:HAS[#ResourceName[*]] {}
		!OUTPUT_RESOURCE:HAS[#ResourceName[*]] {}
		INPUT_RESOURCE {
			ResourceName = LqdOxygen
			Ratio = 0.888745608
			FlowMode = STAGE_PRIORITY_FLOW
		}
		INPUT_RESOURCE {
			ResourceName = LqdHydrogen
			Ratio = 0.899015687
			FlowMode = STAGE_PRIORITY_FLOW
		}
		INPUT_RESOURCE {
			ResourceName = ElectricCharge
			Ratio = 0.04450822
		}
		OUTPUT_RESOURCE {
			ResourceName = HydrogenPeroxide
			Ratio = 0.743278621
			DumpExcess = false
			FlowMode = STAGE_PRIORITY_FLOW
		}
	}
	
	// Hydrazine Production
	+MODULE[ModuleResourceConverter],0 {
		@ConverterName = #OrbitaLoc_ISRU_hydrazine-production_ConverterName
		@StartActionName = #OrbitaLoc_ISRU_hydrazine-production_StartActionName
		@StopActionName = #OrbitaLoc_ISRU_hydrazine-production_StopActionName
		@resourceOutputName = #OrbitaLoc_ISRU_hydrazine-production_resourceOutputName

		!INPUT_RESOURCE:HAS[#ResourceName[*]] {}
		!OUTPUT_RESOURCE:HAS[#ResourceName[*]] {}
		INPUT_RESOURCE {
			ResourceName = LqdAmmonia
			Ratio = 0.766608386
			FlowMode = STAGE_PRIORITY_FLOW
		}
		INPUT_RESOURCE {
			ResourceName = HydrogenPeroxide
			Ratio = 0.370751898
			FlowMode = STAGE_PRIORITY_FLOW
		}
		INPUT_RESOURCE {
			ResourceName = ElectricCharge
			Ratio = 0.80481025
		}
		OUTPUT_RESOURCE {
			ResourceName = Water
			Ratio = 0.569327
			DumpExcess = true
			FlowMode = STAGE_PRIORITY_FLOW
		}
		OUTPUT_RESOURCE {
			ResourceName = Hydrazine
			Ratio = 0.504480957
			DumpExcess = false
			FlowMode = STAGE_PRIORITY_FLOW
		}
	}
	
	// Selective Catalytic Oxidation
	+MODULE[ModuleResourceConverter],0 {
		@ConverterName = #OrbitaLoc_ISRU_selective-catalytic-oxidation_ConverterName
		@StartActionName = #OrbitaLoc_ISRU_selective-catalytic-oxidation_StartActionName
		@StopActionName = #OrbitaLoc_ISRU_selective-catalytic-oxidation_StopActionName
		@resourceOutputName = #OrbitaLoc_ISRU_selective-catalytic-oxidation_resourceOutputName

		!INPUT_RESOURCE:HAS[#ResourceName[*]] {}
		!OUTPUT_RESOURCE:HAS[#ResourceName[*]] {}
		INPUT_RESOURCE {
			ResourceName = LqdOxygen
			Ratio = 0.491507207
			FlowMode = STAGE_PRIORITY_FLOW
		}
		INPUT_RESOURCE {
			ResourceName = LqdAmmonia
			Ratio = 0.566875483
			FlowMode = STAGE_PRIORITY_FLOW
		}
		INPUT_RESOURCE {
			ResourceName = ElectricCharge
			Ratio = 2.0708625
		}
		OUTPUT_RESOURCE {
			ResourceName = Water
			Ratio = 0.631570123
			DumpExcess = false
			FlowMode = STAGE_PRIORITY_FLOW
		}
		OUTPUT_RESOURCE {
			ResourceName = Nitrogen
			Ratio = 261.5850335
			DumpExcess = true
			FlowMode = STAGE_PRIORITY_FLOW
		}
	}
	
	// Water Electrolysis
	+MODULE[ModuleResourceConverter],0 {
		@ConverterName = #OrbitaLoc_ISRU_water-electrolysis_ConverterName
		@StartActionName = #OrbitaLoc_ISRU_water-electrolysis_StartActionName
		@StopActionName = #OrbitaLoc_ISRU_water-electrolysis_StopActionName
		@resourceOutputName = #OrbitaLoc_water-electrolysis_resourceOutputName

		!INPUT_RESOURCE:HAS[#ResourceName[*]] {}
		!OUTPUT_RESOURCE:HAS[#ResourceName[*]] {}
		INPUT_RESOURCE {
			ResourceName = Water
			Ratio = 1.0
			FlowMode = STAGE_PRIORITY_FLOW
		}
		INPUT_RESOURCE {
			ResourceName = ElectricCharge
			Ratio = 23.1633
		}
		OUTPUT_RESOURCE {
			ResourceName = Oxygen
			Ratio = 629.7163121
			DumpExcess = false
			FlowMode = STAGE_PRIORITY_FLOW
		}
		OUTPUT_RESOURCE {
			ResourceName = Hydrogen
			Ratio = 1244.716352
			DumpExcess = true
			FlowMode = STAGE_PRIORITY_FLOW
		}
	}
	
	// Carbon Dioxide Electrolysis
	+MODULE[ModuleResourceConverter],0 {
		@ConverterName = #OrbitaLoc_ISRU_carbon-dioxide-electrolysis_ConverterName
		@StartActionName = #OrbitaLoc_ISRU_carbon-dioxide-electrolysis_StartActionName
		@StopActionName = #OrbitaLoc_ISRU_carbon-dioxide-electrolysis_StopActionName
		@resourceOutputName = #OrbitaLoc_carbon-dioxide-electrolysis_resourceOutputName

		!INPUT_RESOURCE:HAS[#ResourceName[*]] {}
		!OUTPUT_RESOURCE:HAS[#ResourceName[*]] {}
		INPUT_RESOURCE {
			ResourceName = LqdCO2
			Ratio = 1.0
			FlowMode = STAGE_PRIORITY_FLOW
		}
		INPUT_RESOURCE {
			ResourceName = ElectricCharge
			Ratio = 30.92296887
		}
		OUTPUT_RESOURCE {
			ResourceName = Oxygen
			Ratio = 0.747651249
			DumpExcess = false
			FlowMode = STAGE_PRIORITY_FLOW
		}
		OUTPUT_RESOURCE {
			ResourceName = Waste
			Ratio = 0.426906567
			DumpExcess = true
			FlowMode = STAGE_PRIORITY_FLOW
		}
	}
	
	// Methane Pyrolysis
	+MODULE[ModuleResourceConverter],0 {
		@ConverterName = #OrbitaLoc_ISRU_methane-pyrolysis_ConverterName
		@StartActionName = #OrbitaLoc_ISRU_methane-pyrolysis_StartActionName
		@StopActionName = #OrbitaLoc_ISRU_methane-pyrolysis_StopActionName
		@resourceOutputName = #OrbitaLoc_methane-pyrolysis_resourceOutputName

		!INPUT_RESOURCE:HAS[#ResourceName[*]] {}
		!OUTPUT_RESOURCE:HAS[#ResourceName[*]] {}
		INPUT_RESOURCE {
			ResourceName = LqdMethane
			Ratio = 1.0
			FlowMode = STAGE_PRIORITY_FLOW
		}
		INPUT_RESOURCE {
			ResourceName = ElectricCharge
			Ratio = 2.8357689
		}
		OUTPUT_RESOURCE {
			ResourceName = Waste
			Ratio = 0.424929024
			DumpExcess = true
			FlowMode = STAGE_PRIORITY_FLOW
		}
		OUTPUT_RESOURCE {
			ResourceName = Hydrogen
			Ratio = 1189.719611
			DumpExcess = false
			FlowMode = STAGE_PRIORITY_FLOW
		}
	}
	
	// Ammonia Decomposition
	+MODULE[ModuleResourceConverter],0 {
		@ConverterName = #OrbitaLoc_ISRU_ammonia-decomposition_ConverterName
		@StartActionName = #OrbitaLoc_ISRU_ammonia-decomposition_StartActionName
		@StopActionName = #OrbitaLoc_ISRU_ammonia-decomposition_StopActionName
		@resourceOutputName = #OrbitaLoc_ammonia-decomposition_resourceOutputName

		!INPUT_RESOURCE:HAS[#ResourceName[*]] {}
		!OUTPUT_RESOURCE:HAS[#ResourceName[*]] {}
		INPUT_RESOURCE {
			ResourceName = LqdAmmonia
			Ratio = 1.0
			FlowMode = STAGE_PRIORITY_FLOW
		}
		INPUT_RESOURCE {
			ResourceName = ElectricCharge
			Ratio = 1.5862479
		}
		OUTPUT_RESOURCE {
			ResourceName = Nitrogen
			Ratio = 461.5563869
			DumpExcess = false
			FlowMode = STAGE_PRIORITY_FLOW
		}
		OUTPUT_RESOURCE {
			ResourceName = Hydrogen
			Ratio = 1387.018465
			DumpExcess = true
			FlowMode = STAGE_PRIORITY_FLOW
		}
	}

	!MODULE[ModuleResourceConverter]:HAS[@INPUT_RESOURCE:HAS[#ResourceName[Ore]]] {}
}

